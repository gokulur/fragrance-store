{% extends 'base.html' %}
{% block content %}
<title>{% block title %}CART{% endblock %}</title>
<style>
    .disabled {
        opacity: 0.5;
        pointer-events: none;
    }
</style>

<main id="xo-main-content" class="content-for-layout focus-none" role="main" tabindex="-1">
    <div id="shopify-section-template--19284044447934__main-page-heading" class="shopify-section">
        <section class="xo-section xo-section--template--19284044447934__main-page-heading color-background-1" style="--margin: 0;--pt: 50;--pb: 0;
">







            <xo-animate class="xo-section-bg" xo-disabled="" xo-duration="1000"
                style="animation: auto ease 0s 1 normal none running none; opacity: 1;" xo-visible="">

                <xo-parallax xo-lerp-ease="0.4" class="xo-section-bg-image__item">
                    <xo-parallax-scroll
                        xo-keyframes="{ &#39;0%&#39;: { backgroundPositionY: &#39;200px&#39; }, &#39;100%&#39;: { backgroundPositionY: &#39;-200px&#39; }, }"
                        class="xo-section-bg-image__url xo-background-lazyload" xo-fit-content=""
                        style="backface-visibility: hidden; background-size: cover; background-position: 50% -123.761px; background-attachment: fixed;"></xo-parallax-scroll>
                </xo-parallax>


            </xo-animate>


            <xo-container>
                <xo-animate xo-cascade="" xo-type="fade-up"
                    style="opacity: 1; --xo-order: 0; --xo-strength: 1; --xo-constant: 75; --xo-duration: 500; --xo-easing: cubic-bezier(0, 0, 0.3, 1); animation: auto ease 0s 1 normal none running none;"
                    xo-visible="">




                    <div class="xo-page-heading xo-page-heading--center">
                        <h1 class="xo-page-heading__title">


                            Your Shopping Cart


                        </h1>


                        <div class="xo-page-heading__description"></div>



                    </div>

                </xo-animate>
            </xo-container>
        </section>


    </div>
    <div id="shopify-section-template--19284044447934__cart-items" class="shopify-section">








        <div class="xo-section xo-section--template--19284044447934__cart-items color-background-1" style="--margin: 0;--pt: 20;--pb: 50;
">
            <xo-cart id="template--19284044447934__cart-items"
                class="xo-main-cart section-template--19284044447934__cart-items-padding color-background-1">
                <xo-container class="xo-cart">
                    <xo-animate xo-cascade="" xo-type="fade-up"
                        style="opacity: 1; --xo-order: 1; --xo-strength: 1; --xo-constant: 75; --xo-duration: 500; --xo-easing: cubic-bezier(0, 0, 0.3, 1); animation: auto ease 0s 1 normal none running none;"
                        xo-visible="">
                        <xo-cart-will-change xo-unique-id="cart-table-template--19284044447934__cart-items">

                            <xo-grid>
                                <div style="--xs: 12; --sm: 12; --md: 12; --lg: 8;" class="xo-cart__left">
  
                                    <div class="xo-cart-table">
                                        <form action=" " method="post" id="cart">
                                            <table role="table" class="xo-table">
                                                <thead role="rowgroup">
                                                    <tr role="row" class="xo-table__head-row">
                                                        <th role="columnheader">Product</th>
                                                        <th role="columnheader">Quantity</th>
                                                        <th role="columnheader">Total</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {% for item in items %}
                                                    <tr role="row" class="xo-table__body-row"
                                                        data-item-id="{{ item.id }}" id="cart-row-{{ item.id }}">
                                                        <td role="cell" data-th="Product">
                                                            <xo-product
                                                                xo-section-id="template--19284044447934__cart-items"
                                                                xo-product-id="{{ item.product.id }}"
                                                                xo-line="{{ forloop.index }}">

                                                                <div class="xo-cart-item">
                                                                    <a href="" class="xo-cart-item__image">
                                                                        {% if item.product.images.first %}
                                                                        <div class="xo-image"
                                                                            style="--xo-ratio-percent: 1/1; --x-pos: %; --y-pos: %;">
                                                                            <img src="{{ item.product.images.first.image.url }}"
                                                                                alt="{{ item.product.name }}"
                                                                                width="860" height="860" loading="lazy"
                                                                                is="xo-lazyload" sizes="100vw"
                                                                                fetchpriority="auto"
                                                                                xo-intrinsic-width="860"
                                                                                xo-intrinsic-height="860" xo-loaded="">
                                                                        </div>
                                                                        {% else %}
                                                                        <div class="xo-image">
                                                                            <img src="/static/no-image.png"
                                                                                alt="No Image">
                                                                        </div>
                                                                        {% endif %}
                                                                    </a>

                                                                    <div class="xo-cart-item__content">
                                                                        <a href=" " class="xo-cart-item__title">
                                                                            {{ item.product.name }}
                                                                        </a>
                                                                        <div class="xo-cart-item__price">
                                                                            <div class="xo-cart-item__original-price">
                                                                                â‚¹ {{ item.product.price }}
                                                                            </div>
                                                                        </div>

                                                                        <xo-product
                                                                            xo-section-id="template--19284044447934__cart-items"
                                                                            xo-product-id="{{ item.product.id }}">
                                                                            <div class="xo-cart-item__quantity">
                                                                                <div class="xo-cart-table__quantity">
                                                                                    <xo-cart-quantity
                                                                                        class="xo-quantity-style2"
                                                                                        style="--width: 10rem; --height: 4rem"
                                                                                        data-item-id="{{ item.id }}"
                                                                                        aria-labelledby="quantity-template--19284044447934__cart-items">

                                                                                        <a href="{% url 'decrease_qty' item.id %}"
                                                                                            class="xo-quantity-style2__button decrease-qty"
                                                                                            data-item-id="{{ item.id }}"
                                                                                            data-url="{% url 'decrease_qty' item.id %}">â€“</a>

                                                                                        <input type="text"
                                                                                            value="{{ item.quantity }}"
                                                                                            readonly
                                                                                            class="xo-quantity-style2__number item-quantity-{{ item.id }}">

                                                                                        <a href="{% url 'increase_qty' item.id %}"
                                                                                            class="xo-quantity-style2__button increase-qty"
                                                                                            data-item-id="{{ item.id }}"
                                                                                            data-url="{% url 'increase_qty' item.id %}">+</a>
                                                                                    </xo-cart-quantity>
                                                                                </div>
                                                                            </div>
                                                                        </xo-product>

                                                                        <div class="xo-cart-item__options">
                                                                            <div class="xo-cart-item__option">
                                                                                <span>Title:</span>
                                                                                <span>{{ item.product.name }}</span>
                                                                            </div>
                                                                        </div>

                                                                        <xo-cart-remove>
                                                                            <button
                                                                                class="xo-btn xo-btn--dark xo-btn--link xo-btn--slide-up remove-item-btn"
                                                                                style="cursor: pointer;"
                                                                                data-item-id="{{ item.id }}"
                                                                                onclick="window.location.href='{% url 'remove_item' item.id %}'"
                                                                                aria-label="Remove {{ item.product.name }}">

                                                                                <span class="xo-btn__content">
                                                                                    <span class="xo-btn__text"
                                                                                        data-text="Delete">Delete</span>
                                                                                </span>

                                                                                <span class="xo-btn__loading">
                                                                                    <div class="xo-loader-3"
                                                                                        style="--size: 8; --color: currentColor; --duration: 1000;">
                                                                                        <div></div>
                                                                                    </div>
                                                                                </span>
                                                                            </button>
                                                                        </xo-cart-remove>

                                                                        <xo-cart-change-fallback>
                                                                            <div class="xo-loader-2"
                                                                                style="--size: 26; --color: currentColor; --duration: 1000; --stroke-width: 2;">
                                                                                <div></div>
                                                                            </div>
                                                                        </xo-cart-change-fallback>
                                                                    </div>
                                                                </div>
                                                            </xo-product>
                                                        </td>

                                                        <td role="cell" data-th="Quantity">
                                                            <xo-product
                                                                xo-section-id="template--19284044447934__cart-items"
                                                                xo-product-id="{{ item.product.id }}"
                                                                xo-line="{{ forloop.index }}">
                                                                <div class="xo-cart-table__quantity">
                                                                    <xo-cart-quantity class="xo-quantity-style2"
                                                                        style="--width: 10rem; --height: 4rem"
                                                                        data-item-id="{{ item.id }}"
                                                                        aria-labelledby="quantity-template--19284044447934__cart-items">

                                                                        <a href="{% url 'decrease_qty' item.id %}"
                                                                            class="xo-quantity-style2__button decrease-qty"
                                                                            data-item-id="{{ item.id }}"
                                                                            data-url="{% url 'decrease_qty' item.id %}">â€“</a>

                                                                        <input type="text" value="{{ item.quantity }}"
                                                                            readonly
                                                                            class="xo-quantity-style2__number item-quantity-{{ item.id }}">

                                                                        <a href="{% url 'increase_qty' item.id %}"
                                                                            class="xo-quantity-style2__button increase-qty"
                                                                            data-item-id="{{ item.id }}"
                                                                            data-url="{% url 'increase_qty' item.id %}">+</a>
                                                                    </xo-cart-quantity>
                                                                </div>
                                                            </xo-product>
                                                        </td>

                                                        <td role="cell" data-th="Total">
                                                            <div class="xo-cart-table__price item-total-{{ item.id }}">
                                                                â‚¹{{ item.total_price }}

                                                            </div>
                                                        </td>
                                                    </tr>
                                                    {% endfor %}
                                                </tbody>

                                            </table>
                                        </form>
                                    </div>

                                    <xo-cart-will-change
                                        xo-unique-id="continue-shopping-template--19284044447934__cart-items">
                                        <div class="xo-space xo-space--vertical" style="--space: 1rem"></div>
                                        <a href="https://borcen-store-newdemo.myshopify.com/collections/all">

                                            <button class="xo-btn xo-btn--dark xo-btn--link
 xo-btn--slide-up" style="">

                                                <span class="xo-btn__content">
                                                    <a href="{% url 'all_collections' %}" class="xo-btn__text"
                                                        data-text="Continue shopping">
                                                        Continue shopping
                                                    </a>
                                                </span>
                                                <span class="xo-btn__loading">
                                                    <div class="xo-loader-3"
                                                        style="--size: 8; --color: currentColor; --duration: 1000;">
                                                        <div></div>
                                                    </div>

                                                </span>
                                            </button>
                                        </a>
                                    </xo-cart-will-change>
                                </div>
                                <div style="--md: 12; --lg: 4" class="xo-cart__right">
                                    <xo-cart-free-shipping-custom
                                        xo-free-shipping-notice="Congrats! You are eligible for FREE Shipping"
                                        xo-free-shipping-progress="Buy {{ money }} more to enjoy FREE shipping">
                                        <div class="xo-cart-free-shipping">
                                            <xo-cart-will-change xo-unique-id="xo-cart-free-shipping-checking-inner"
                                                class="xo-cart-free-shipping-checking-inner xo-visually-hidden"
                                                xo-total-price="7000">7000</xo-cart-will-change>
                                            <xo-cart-will-change xo-unique-id="xo-cart-free-shipping-checking"
                                                class="xo-cart-free-shipping__checking">70.0</xo-cart-will-change>
                                            <div class="xo-cart-free-shipping__position">
                                                <!-- <xo-cart-will-change xo-unique-id="xo-cart-free-shipping-text"
                                                    class="xo-cart-free-shipping__text">Buy $530 USD more to enjoy FREE
                                                    shipping</xo-cart-will-change> -->
                                                <!-- <div class="xo-cart-free-shipping__progress xo-cart-free-shipping__progress--level-1"
                                                    style="--progress: 11.666666666666666%;">
                                                    70.0
                                                </div> -->
                                            </div>
                                        </div>
                                    </xo-cart-free-shipping-custom>

                                    <div class="xo-space xo-space--vertical" style="--space: 2rem"></div>


                                    <xo-cart-will-change
                                        xo-unique-id="xo-cart-note-template--19284044447934__cart-items">

                                    </xo-cart-will-change>
                                    <div class="xo-space xo-space--vertical" style="--space: 2rem"></div>

                                    <xo-cart-will-change class="xo-cart-totals">
                                        <div class="xo-cart-totals__subtotal">Total</div>
                                        <div class="xo-cart-table__price" id="cart-total">
                                            â‚¹{{ total }}
                                        </div>
                                    </xo-cart-will-change>




                                    <xo-cart-will-change
                                        xo-unique-id="xo-cart-tax-note-template--19284044447934__cart-items"
                                        class="xo-cart-tax-note">
                                        
                                        Taxes and <a href="{% url 'checkout_page' %}">shipping</a>
                                        calculated at checkout

                                    </xo-cart-will-change>

                                    <xo-cart-will-change xo-unique-id="xo-space-2-template--19284044447934__cart-items">




                                        <div class="xo-space xo-space--vertical" style="--space: 1rem"></div>

                                    </xo-cart-will-change>


                                    <xo-cart-will-change
                                        xo-unique-id="xo-discount-list-template--19284044447934__cart-items"
                                        class="xo-discount-list">
                                    </xo-cart-will-change>



                                    <xo-cart-will-change xo-unique-id="xo-actions-template--19284044447934__cart-items"
                                        class="xo-actions">

                                        <noscript>

                                            <button class='xo-btn xo-btn--dark xo-btn--secondary
 xo-btn--md xo-btn--slide-up xo-btn--block' style='' type='submit' form='cart'>

                                                <span class="xo-btn__content">
                                                    <span class="xo-btn__text" data-text="Update">
                                                        Update
                                                    </span>
                                                </span>
                                                <span class="xo-btn__loading">
                                                    <div class='xo-loader-3'
                                                        style='--size: 8; --color: currentColor; --duration: 1000;'>
                                                        <div></div>
                                                    </div>
                                                </span>
                                            </button>
                                        </noscript>
                                        <button 
    class="xo-btn xo-btn--dark xo-btn--secondary xo-btn--md xo-btn--slide-up xo-btn--block
    {% if total == 0 %} disabled-btn {% endif %}"
    
    {% if total == 0 %}
        type="button"
        style="pointer-events: none;"
    {% else %}
        type="submit"
        form="cart"
        name="checkout"
    {% endif %}
>
    <span class="xo-btn__content">
       <a href="{% url 'checkout_page' %}?from=cart" class="xo-btn__text" data-text="Check Out">
    Check Out
</a>
    </span>

    <span class="xo-btn__loading">
        <div class="xo-loader-3"
            style="--size: 8; --color: currentColor; --duration: 1000;">
            <div></div>
        </div>
    </span>
</button>




                                    </xo-cart-will-change>





                                    <div class="xo-space xo-space--vertical" style="--space: 2rem"></div>






                                </div>
                            </xo-grid>

                        </xo-cart-will-change>
                    </xo-animate>
                </xo-container>
            </xo-cart>
        </div>


    </div>
    <section id="shopify-section-template--19284044447934__featured-collection" class="shopify-section section">



        <div class="xo-section xo-section--template--19284044447934__featured-collection color-background-1" style="--margin: 0;--pt: 36;--pb: 36;
">







            <xo-animate class="xo-section-bg" xo-disabled="" xo-duration="1000"
                style="animation: auto ease 0s 1 normal none running none; opacity: 1;" xo-visible="">

                <xo-parallax xo-lerp-ease="0.4" class="xo-section-bg-image__item">
                    <xo-parallax-scroll
                        xo-keyframes="{ &#39;0%&#39;: { backgroundPositionY: &#39;200px&#39; }, &#39;100%&#39;: { backgroundPositionY: &#39;-200px&#39; }, }"
                        class="xo-section-bg-image__url xo-background-lazyload" xo-fit-content=""
                        style="backface-visibility: hidden; background-size: cover; background-position: 50% 135.801px; background-attachment: fixed;"></xo-parallax-scroll>
                </xo-parallax>


            </xo-animate>


 <script>
document.addEventListener("click", function (e) {

    // ---------- INCREASE / DECREASE ----------
    const qtyBtn = e.target.closest(".increase-qty, .decrease-qty");
    if (qtyBtn) {
        e.preventDefault();
        e.stopImmediatePropagation(); // ðŸ”¥ IMPORTANT FIX

        let itemID = qtyBtn.dataset.itemId;
        let url = qtyBtn.dataset.url;

        fetch(url, {
            method: "GET",
            headers: { "X-Requested-With": "XMLHttpRequest" }
        })
            .then(res => res.json())
            .then(data => {

                if (data.deleted) {
                    document.getElementById("cart-row-" + itemID).remove();
                    return;
                }

                // Update Quantity
                document.querySelectorAll(".item-quantity-" + itemID)
                    .forEach(el => el.value = data.quantity);

                // Update totals
                document.querySelector(".item-total-" + itemID).innerHTML = "â‚¹" + data.item_total;
                document.getElementById("cart-total").innerHTML = "â‚¹" + data.cart_total;

            });

        return; // ðŸ”¥ Prevent second handler firing
    }


    // ---------- REMOVE ITEM ----------
    const removeBtn = e.target.closest(".remove-item-btn");
    if (removeBtn) {
        e.preventDefault();
        e.stopImmediatePropagation();  
        let itemID = removeBtn.dataset.itemId;
        let url = removeBtn.dataset.url;

        fetch(url, {
            method: "GET",
            headers: { "X-Requested-With": "XMLHttpRequest" }
        })
            .then(res => res.json())
            .then(data => {

                const row = document.getElementById("cart-row-" + itemID);
                row.style.opacity = "0";
                setTimeout(() => row.remove(), 250);

                document.getElementById("cart-total").innerHTML = "â‚¹" + data.cart_total;
            });
    }

});
</script>



            {% endblock %}